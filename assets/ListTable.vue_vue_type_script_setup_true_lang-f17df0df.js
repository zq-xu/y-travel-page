import{_ as I,a as j}from"./refresh-a3259f6e.js";import{d as B,r as m,w as T,aH as N,aK as E,aL as u,aQ as t,aR as w,aO as F,aJ as P,aI as U,aU as J,aM as d,ae as $,c as K,bi as M,bm as O,ab as D,ak as V,aP as Q,aN as R,av as q}from"./index-7d88c287.js";import{u as A}from"./use-loading-37c1118f.js";import{V as G,_ as W}from"./vuedraggable.umd-64e6f377.js";import{N as X}from"./Checkbox-9ba985cc.js";import{N as Y}from"./Popover-5b10a0f7.js";import{N as z}from"./Space-9d9d608e.js";import{_ as Z}from"./DataTable-895cc5c9.js";const ee={class:"w-180px"},ae={key:0,class:"flex-y-center h-36px px-12px hover:bg-primary_active"},ne=B({__name:"ColumnSetting",props:{columns:{}},emits:["update:columns"],setup(x,{expose:y,emit:b}){const a=x,c=m(g());function g(){return a.columns.map(n=>({...n,checked:!0}))}function v(n){c.value=n.map(s=>{const l=c.value.findIndex(i=>i.key===s.key);return l>=0?{...s,checked:c.value[l].checked}:{...s,checked:!0}}),_(c.value)}function _(n){const l=n.filter(i=>i.checked).map(i=>{const o={...i};return delete o.checked,o});b("update:columns",l)}return T(c,n=>{_(n)},{deep:!0}),y({refreshList:v}),(n,s)=>{const l=I,i=$,o=W,k=X,C=Y;return N(),E(C,{placement:"bottom",trigger:"click"},{trigger:u(()=>[t(i,{size:"small",type:"primary"},{default:u(()=>[t(l,{class:"mr-4px text-16px"}),w(" "+F(n.$t("yTravel.common.tableColumnSetting")),1)]),_:1})]),default:u(()=>[P("div",ee,[t(d(G),{modelValue:c.value,"onUpdate:modelValue":s[0]||(s[0]=r=>c.value=r),"item-key":"key"},{item:u(({element:r})=>[r.key?(N(),U("div",ae,[t(o,{class:"mr-8px text-20px cursor-move"}),t(k,{checked:r.checked,"onUpdate:checked":p=>r.checked=p},{default:u(()=>[w(F(r.title),1)]),_:2},1032,["checked","onUpdate:checked"])])):J("",!0)]),_:1},8,["modelValue"])])]),_:1})}}}),de=B({__name:"ListTable",props:{data:{default:void 0},initLoad:{type:Boolean,default:!0},disableHeader:{type:Boolean,default:!1},disablePagination:{type:Boolean,default:!1},columnsFn:{},actionColumnsFn:{type:Function,default:void 0},loadData:{type:Function,default:void 0}},emits:["update:data","update:columns"],setup(x,{expose:y,emit:b}){const a=x,c=m(!a.disableHeader),g=m(1),v=m([]),_=K({get(){return a.data??v.value},set(e){a.data?b("update:data",e):v.value=e}}),n=m(s(a.columnsFn?a.columnsFn():[]));function s(e){return a.actionColumnsFn?e.concat(a.actionColumnsFn()):e}const l=m(),{locale:i}=M();T(i,()=>{var h;const e=a.columnsFn?a.columnsFn().map(S=>({...S})):[],f=s(e);n.value=f,(h=l.value)==null||h.refreshList(f)},{deep:!0});const o=a.disablePagination?void 0:O({class:"center",page:1,pageSize:10,showSizePicker:!0,pageCount:g,pageSizes:[10,15,20,25,30],onChange:e=>{o.page=e,p()},onUpdatePageSize:e=>{o.pageSize=e,o.page=1,p()}}),{loading:k,startLoading:C,endLoading:r}=A(!1);async function p(){if(C(),a.loadData){const{data:e}=await a.loadData("",{pageNum:(o.page??1).toString(),pageSize:(o.pageSize??10).toString()});e&&(_.value=e.items,g.value=e.pageCount)}setTimeout(()=>{r()},300)}function H(){a.initLoad&&p()}return H(),y({loadTableData:p}),(e,f)=>{const h=j,S=Z;return N(),U(q,null,[D(P("div",null,[t(d(z),{class:"pb-12px",justify:"space-between"},{default:u(()=>[t(d(z),{align:"center",size:18},{default:u(()=>[Q(e.$slots,"default")]),_:3}),t(d(z),{align:"center",size:18},{default:u(()=>[D(t(d($),{size:"small",type:"primary",onClick:p},{default:u(()=>[t(h,{class:R(["mr-4px text-16px",{"animate-spin":d(k)}])},null,8,["class"]),w(" "+F(e.$t("yTravel.common.refresh")),1)]),_:1},512),[[V,a.loadData!=null]]),t(ne,{ref_key:"columnSetting",ref:l,columns:n.value,"onUpdate:columns":f[0]||(f[0]=L=>n.value=L)},null,8,["columns"])]),_:1})]),_:3})],512),[[V,c.value]]),t(S,{remote:"",columns:n.value,data:_.value,loading:d(k),pagination:d(o)},null,8,["columns","data","loading","pagination"])],64)}}});export{de as _};
